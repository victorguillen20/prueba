<div class="container-buttons">
  <input type="text" placeholder="Search..." (input)="onSearchInput($event)" [class.skeleton]="isLoading" [disabled]="isLoading">
  <button class="btn secondary" (click)="navigateToForm()" [class.skeleton]="isLoading" [disabled]="isLoading">
    <span *ngIf="!isLoading">Agregar</span>
  </button>
</div>
<div class="container-table">
  <div class="table-all-content">
    <table class="styled-table">
      <thead>
        <tr>
          <th class="th-center">Logo</th>
          <th>Nombre del Producto</th>
          <th>Descripción <span class="icon-svg"></span></th>
          <th>Fecha de liberación <span class="icon-svg"></span></th>
          <th>Fecha de reestructuración <span class="icon-svg"></span></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <!-- Skeleton Loader -->
        <ng-container *ngIf="isLoading">
          <tr *ngFor="let skeleton of skeletonRows; let i = index" class="skeleton-row skeleton-table">
            <td class="td-center skeleton-cell">
              <div class="skeleton skeleton-content skeleton-avatar"></div>
            </td>
            <td class="td-center skeleton-cell">
              <div class="skeleton skeleton-content skeleton-text-medium"></div>
            </td>
            <td class="td-center skeleton-cell">
              <div class="skeleton skeleton-content skeleton-text-long"></div>
            </td>
            <td class="td-center skeleton-cell">
              <div class="skeleton skeleton-content skeleton-text-short"></div>
            </td>
            <td class="td-center skeleton-cell">
              <div class="skeleton skeleton-content skeleton-text-short"></div>
            </td>
            <td class="skeleton-cell">
              <div class="skeleton skeleton-content skeleton-button"></div>
            </td>
          </tr>
        </ng-container>

        <!-- Datos reales -->
        <ng-container *ngIf="!isLoading">
          <tr *ngFor="let product of pagedProducts">
            <td class="td-center">
                <span *ngIf="!product.logo" class="icon-img"></span>
                <img *ngIf="product.logo" class="icon-img-1" [src]="product.logo" alt="Logo"/>
            </td>
            <td class="td-center">{{ product.name }}</td>
            <td class="td-center">{{ product.description }}</td>
            <td class="td-center">{{ product.date_release | date:'dd/MM/yyyy' }}</td>
            <td class="td-center">{{ product.date_revision | date:'dd/MM/yyyy' }}</td>
            <td>
              <div class="dropdown">
                <button class="button-icon"></button>
                <div class="dropdown-content">
                  <button (click)="editProduct(product)">Actualizar</button>
                  <button (click)="openDeleteModal(product)">Eliminar</button>
                </div>
              </div>
            </td>
          </tr>
        </ng-container>
      </tbody>
    </table>    
  </div>
  <div class="horizontal-scroll-bar">
    <div class="horizontal-porcentaje"></div>
  </div>
  <div class="separator"></div>
  <div class="footer-table">
    <ng-container *ngIf="!isLoading">
      <span>{{ products.length }} Resultados</span>
      <select class="page-selector" (change)="updateSelectedOption($event)">
        <option [selected]="selectedOption === 5" value="5">5</option>
        <option [selected]="selectedOption === 10" value="10">10</option>
        <option [selected]="selectedOption === 20" value="20">20</option>
      </select>
    </ng-container>
    <ng-container *ngIf="isLoading">
      <div class="skeleton skeleton-content skeleton-text-short" style="height: 20px; width: 120px;"></div>
      <div class="skeleton skeleton-content" style="height: 32px; width: 60px; border-radius: 4px;"></div>
    </ng-container>
  </div>
</div>


<div class="modal-overlay" *ngIf="deleteModalVisible">
  <div class="modal-container">
    <p>¿Estás seguro de eliminar el producto {{ productToDelete?.name }}?</p>
    <br>
    <br>
    <div class="separator overview"></div>
    <div class="modal-buttons">
      <button class="btn primary btn-all-w" (click)="closeDeleteModal()">Cancelar</button>
      <button class="btn secondary btn-all-w" (click)="confirmDelete()">Confirmar</button>
    </div>
  </div>
</div>

<div class="alert-overlay" *ngIf="alertMessage">
  <div class="alert-modal" [ngClass]="{'success': alertType === 'success', 'error': alertType === 'error'}">
    {{ alertMessage }}
  </div>
</div>